apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'jetty'

sourceCompatibility = '1.7'
archivesBaseName = 'sc'

repositories {
    maven {
        url "http://gemjars.org/maven"
    }
    mavenCentral()
    mavenLocal()
}

dependencies {
    String jerseyVersion = "1.16"

    compile module("org.jruby.rack:jruby-rack:1.1.9") {
        dependency "org.jruby:jruby-complete:1.7.1"
    }
    compile "javax.servlet:servlet-api:2.5", //"javax:javaee-web-api:6.0",
            "org.rubygems:sinatra:1.3.3",
            "org.apache.solr:solr-core:4.0.0",
            "com.sun.jersey:jersey-core:$jerseyVersion",
            "com.sun.jersey:jersey-server:$jerseyVersion",
            "com.sun.jersey:jersey-client:$jerseyVersion",
            "com.sun.jersey:jersey-grizzly2:$jerseyVersion",
            "com.sun.jersey:jersey-json:$jerseyVersion",
            "org.glassfish.grizzly:grizzly-http-servlet:2.2.18",
            "commons-io:commons-io:2.4"
}

sourceSets {
    main {
        resources {
            srcDir "src/main/ruby"
            srcDir "src/main/java"
        }
    }
}

jar {
    manifest {
        attributes('Main-Class': 'org.watermint.sourcecolon.Main')
    }
    from configurations.runtime.collect { it.isDirectory() ? it : zipTree(it) }
}
